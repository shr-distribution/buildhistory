\tupdate-alternatives --install /boot/uImage uImage uImage-3.2.52 30202 || true\n\tif [ ! -e "$D/lib/modules/3.2.52" ]; then\n\t\tmkdir -p $D/lib/modules/3.2.52\n\tfi\n\tif [ -n "$D" ]; then\n\t\tdepmodwrapper -a -b $D 3.2.52\n\telse\n\t\tdepmod -a 3.2.52\n\tfi\n\n# Get the lastest root file system value of boot args\nboot_arg=`cat /proc/cmdline |tr " " "\\n"|grep "root=" |tail -n 1`\nhas_mtdblock=`echo $boot_arg |grep mtdblock`\nhas_ubi=`echo $boot_arg |grep ubi`\n\nif test "x$D" != "x"; then\n    exit 1\nelif test "empty$has_mtdblock" != "empty" -o "empty$has_ubi" != "empty"; then\n    if [ -f /etc/default/flashkernel ] ; then\n        echo "Upgrading Kernel in Flash"\n        echo "DO NOT stop this process"\n\n        MTD_KERNEL_PARTITION=`cat /proc/mtd | grep kernel | cut -d\':\' -f1`\n        MTD_KERNEL_PARTITION=/dev/$MTD_KERNEL_PARTITION\n\n        if [ "x$MTD_KERNEL_PARTITION" = "x" ] ; then\n            exit 1\n        fi\n\n        if [ ! -f /boot/uImage-3.2.52 ] ; then\n            exit 1\n        fi\n\n        /usr/sbin/flash_eraseall $MTD_KERNEL_PARTITION\n        /usr/sbin/nandwrite -p $MTD_KERNEL_PARTITION /boot/uImage-3.2.52\n    else\n        touch /etc/default/flashkernel\n    fi\nelse\n        echo "You are not booting from NAND, don\'t flash kernel into mtdblock."\nfi\n